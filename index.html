<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Picks Dashboard - 2025 Season</title>
    <link rel="icon" type="image/svg+xml" href="https://static.www.nfl.com/image/upload/v1554321393/league/nvfr7ogywskqrfaiu38m.svg">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- Pull to Refresh Indicator (mobile only) -->
    <div class="pull-to-refresh" id="pull-to-refresh">
        <div class="pull-to-refresh-content">
            <div class="pull-to-refresh-icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
                </svg>
            </div>
            <span class="pull-to-refresh-text">Pull to refresh</span>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <a href="/" title="Home"><img src="https://static.www.nfl.com/image/upload/v1554321393/league/nvfr7ogywskqrfaiu38m.svg" alt="NFL Logo" class="nfl-logo"></a>
                <div class="header-text">
                    <h1>NFL Picks Dashboard</h1>
                    <p class="subtitle">2025 Season Tracker</p>
                </div>
                <button class="dark-mode-toggle" id="dark-mode-toggle" title="Toggle dark mode" aria-label="Toggle dark mode">
                    <span class="icon-sun" aria-hidden="true">&#9728;</span>
                    <span class="icon-moon" aria-hidden="true">&#9790;</span>
                </button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main id="dashboard" class="dashboard">
            <!-- Main Tabs -->
            <section class="category-tabs">
                <button class="tab tab-picks active" data-category="make-picks">Make Picks</button>
                <button class="tab" data-category="standings">Standings</button>
                <button class="tab" data-category="vs-market">vs Market</button>
            </section>

            <!-- Standings Sub-tabs (only visible when Standings is active) -->
            <section class="standings-subtabs hidden" id="standings-subtabs">
                <button class="subtab active" data-subcategory="blazin">Blazin' 5</button>
                <button class="subtab" data-subcategory="line">Line Picks</button>
                <button class="subtab" data-subcategory="winner">Straight Up</button>
            </section>

            <!-- Loading State with Skeleton Screens -->
            <section class="loading-state" id="loading-state">
                <!-- Progress Indicator -->
                <div class="loading-progress">
                    <div class="loading-progress-bar">
                        <div class="loading-progress-fill" id="loading-progress-fill"></div>
                    </div>
                    <p class="loading-progress-text" id="loading-progress-text">Loading dashboard data...</p>
                </div>

                <!-- Skeleton Leaderboard -->
                <div class="skeleton-leaderboard">
                    <div class="skeleton-picker-card">
                        <div class="skeleton-picker-header">
                            <div class="skeleton skeleton-text lg" style="width: 120px; margin: 0;"></div>
                        </div>
                        <div class="skeleton-picker-body">
                            <div class="skeleton-picker-stats">
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                            </div>
                            <div class="skeleton skeleton-picker-bar"></div>
                        </div>
                    </div>
                    <div class="skeleton-picker-card">
                        <div class="skeleton-picker-header">
                            <div class="skeleton skeleton-text lg" style="width: 100px; margin: 0;"></div>
                        </div>
                        <div class="skeleton-picker-body">
                            <div class="skeleton-picker-stats">
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                            </div>
                            <div class="skeleton skeleton-picker-bar"></div>
                        </div>
                    </div>
                    <div class="skeleton-picker-card">
                        <div class="skeleton-picker-header">
                            <div class="skeleton skeleton-text lg" style="width: 90px; margin: 0;"></div>
                        </div>
                        <div class="skeleton-picker-body">
                            <div class="skeleton-picker-stats">
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                            </div>
                            <div class="skeleton skeleton-picker-bar"></div>
                        </div>
                    </div>
                    <div class="skeleton-picker-card">
                        <div class="skeleton-picker-header">
                            <div class="skeleton skeleton-text lg" style="width: 110px; margin: 0;"></div>
                        </div>
                        <div class="skeleton-picker-body">
                            <div class="skeleton-picker-stats">
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                                <div class="skeleton"></div>
                            </div>
                            <div class="skeleton skeleton-picker-bar"></div>
                        </div>
                    </div>
                </div>

                <!-- Skeleton Games (for Make Picks tab) -->
                <div class="skeleton-games" id="skeleton-games" style="display: none;">
                    <div class="skeleton-game-card">
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 80%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 70%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                    </div>
                    <div class="skeleton-game-card">
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 75%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 85%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                    </div>
                    <div class="skeleton-game-card">
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 65%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 90%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                    </div>
                    <div class="skeleton-game-card">
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 82%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                        <div class="skeleton-team-row">
                            <div class="skeleton skeleton-avatar"></div>
                            <div class="skeleton-team-info">
                                <div class="skeleton skeleton-text" style="width: 68%;"></div>
                                <div class="skeleton skeleton-text sm"></div>
                            </div>
                            <div class="skeleton skeleton-spread"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Error State -->
            <section class="error-state hidden" id="error-state">
                <div class="error-icon">!</div>
                <h3>Failed to Load Data</h3>
                <p id="error-message">Unable to connect to the data source. Please check your internet connection.</p>
                <button class="btn btn-primary" id="retry-btn">Try Again</button>
            </section>

            <!-- PRIMARY: Leaderboard -->
            <section class="leaderboard hidden" id="leaderboard">
                <!-- Cards will be injected here -->
            </section>

            <!-- SECONDARY: Performance & Insights -->
            <section class="consolidated-section performance-insights-section hidden" id="performance-insights-section">
                <div class="consolidated-header">
                    <h2 class="consolidated-title">Performance & Insights</h2>
                </div>
                <div class="consolidated-tabs">
                    <button class="consolidated-tab active" data-panel="charts-panel">Charts</button>
                    <button class="consolidated-tab" data-panel="insights-panel">Insights</button>
                    <button class="consolidated-tab" data-panel="patterns-panel">Patterns</button>
                    <button class="consolidated-tab" data-panel="pnl-panel">Profit/Loss</button>
                </div>
                <div class="consolidated-content">
                    <!-- Charts Panel -->
                    <div class="consolidated-panel active" id="charts-panel">
                        <div class="charts-grid-content">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3>Weekly Performance Trend</h3>
                                    <button class="chart-zoom-btn" id="toggle-trend-zoom" title="Toggle zoom level">Zoom In</button>
                                </div>
                                <canvas id="trend-chart"></canvas>
                            </div>
                            <div class="chart-container" id="standings-chart-container">
                                <h3>Favorites vs Underdogs</h3>
                                <canvas id="standings-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    <!-- Insights Panel -->
                    <div class="consolidated-panel" id="insights-panel">
                        <div class="insights-grid" id="insights-grid">
                            <div class="insight-card consensus" id="consensus-card"></div>
                            <div class="insight-card lone-wolf" id="lone-wolf-card"></div>
                        </div>
                        <h4 class="insights-section-title">Group Performance</h4>
                        <div class="group-stats-grid" id="group-stats-grid"></div>
                    </div>
                    <!-- Patterns Panel -->
                    <div class="consolidated-panel" id="patterns-panel">
                        <div class="patterns-controls">
                            <div class="patterns-filters">
                                <select id="patterns-picker-filter" class="patterns-filter-select">
                                    <option value="all">All Pickers</option>
                                </select>
                                <div class="patterns-type-filters">
                                    <button class="pattern-type-btn active" data-type="all">All</button>
                                    <button class="pattern-type-btn" data-type="team">Teams</button>
                                    <button class="pattern-type-btn" data-type="primetime">Primetime</button>
                                </div>
                            </div>
                        </div>
                        <div class="patterns-grid" id="patterns-grid"></div>
                    </div>
                    <!-- P&L Panel -->
                    <div class="consolidated-panel" id="pnl-panel">
                        <div class="pnl-controls">
                            <label for="bet-amount">Bet Amount per Pick: $</label>
                            <input type="number" id="bet-amount" class="bet-amount-input" value="20" min="1" max="10000" step="1">
                            <p class="pnl-description">Assumes -110 odds on all spread picks. Shows what you would have won or lost betting this amount on every pick.</p>
                        </div>
                        <div class="pnl-grid" id="pnl-grid"></div>
                    </div>
                </div>
            </section>

            <!-- TERTIARY: Records & Analysis -->
            <section class="consolidated-section records-analysis-section hidden" id="records-analysis-section">
                <div class="consolidated-header">
                    <h2 class="consolidated-title">Records & Analysis</h2>
                </div>
                <div class="consolidated-tabs">
                    <button class="consolidated-tab active" data-panel="blazin-records-panel">Blazin' 5 Records</button>
                    <button class="consolidated-tab" data-panel="team-records-panel">Team Records</button>
                </div>
                <div class="consolidated-content">
                    <!-- Blazin' 5 Records Panel -->
                    <div class="consolidated-panel active" id="blazin-records-panel">
                        <div class="blazin-records-controls">
                            <label for="blazin-records-picker">Picker:</label>
                            <select id="blazin-records-picker" class="team-records-dropdown">
                                <option value="Stephen">Stephen</option>
                                <option value="Sean">Sean</option>
                                <option value="Dylan">Dylan</option>
                                <option value="Jason">Jason</option>
                                <option value="Daniel">Daniel</option>
                            </select>
                        </div>
                        <div class="blazin-records-grid">
                            <div class="blazin-records-column">
                                <h4 class="records-column-title">By Team</h4>
                                <div class="team-records-table-container">
                                    <table class="team-records-table" id="blazin-team-records-table">
                                        <thead>
                                            <tr>
                                                <th class="sortable" data-sort="team" data-table="blazin">Team <span class="sort-icon"></span></th>
                                                <th class="sortable active desc" data-sort="record" data-table="blazin">Record <span class="sort-icon">▼</span></th>
                                                <th class="sortable" data-sort="picks" data-table="blazin"># Picks <span class="sort-icon"></span></th>
                                                <th class="sortable" data-sort="pct" data-table="blazin">Win % <span class="sort-icon"></span></th>
                                            </tr>
                                        </thead>
                                        <tbody id="blazin-team-records-body"></tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="blazin-records-column">
                                <h4 class="records-column-title">By Spread Size</h4>
                                <div class="team-records-table-container">
                                    <table class="team-records-table" id="blazin-spread-records-table">
                                        <thead>
                                            <tr>
                                                <th class="sortable" data-sort="spread" data-table="spread">Spread <span class="sort-icon"></span></th>
                                                <th class="sortable active desc" data-sort="record" data-table="spread">Record <span class="sort-icon">▼</span></th>
                                                <th class="sortable" data-sort="picks" data-table="spread"># Picks <span class="sort-icon"></span></th>
                                                <th class="sortable" data-sort="pct" data-table="spread">Win % <span class="sort-icon"></span></th>
                                            </tr>
                                        </thead>
                                        <tbody id="blazin-spread-records-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Team Records Panel (Line Picks) -->
                    <div class="consolidated-panel" id="team-records-panel">
                        <div class="team-records-controls">
                            <label for="team-records-picker">Picker:</label>
                            <select id="team-records-picker" class="team-records-dropdown">
                                <option value="Stephen">Stephen</option>
                                <option value="Sean">Sean</option>
                                <option value="Dylan">Dylan</option>
                                <option value="Jason">Jason</option>
                                <option value="Daniel">Daniel</option>
                            </select>
                        </div>
                        <div class="team-records-table-container">
                            <table class="team-records-table" id="team-records-table">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-sort="team" data-table="line">Team <span class="sort-icon"></span></th>
                                        <th class="sortable" data-sort="record" data-table="line">Record <span class="sort-icon"></span></th>
                                        <th class="sortable" data-sort="picks" data-table="line"># Picks <span class="sort-icon"></span></th>
                                        <th class="sortable active desc" data-sort="pct" data-table="line">Win % <span class="sort-icon">▼</span></th>
                                    </tr>
                                </thead>
                                <tbody id="team-records-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Make Picks Section -->
            <section id="make-picks-section" class="make-picks-section">
                <div class="picks-header">
                    <h2><span id="picks-week-num">--</span></h2>
                </div>

                <!-- Week and Picker Selection -->
                <div class="selection-row">
                    <div class="week-selector">
                        <label for="week-dropdown">Select Week:</label>
                        <div class="week-nav-row">
                            <button class="week-nav-btn" id="prev-week-btn" title="Previous Week" aria-label="Go to previous week">&#8592;</button>
                            <select id="week-dropdown" class="week-dropdown">
                                <!-- Week options will be injected here -->
                            </select>
                            <button class="week-nav-btn" id="next-week-btn" title="Next Week" aria-label="Go to next week">&#8594;</button>
                        </div>
                        <span id="week-loading" class="week-loading hidden">Loading...</span>
                    </div>

                    <div class="picker-selector">
                        <label for="picker-dropdown">Picks for:</label>
                        <div class="picker-nav-row">
                            <button class="picker-nav-btn" id="prev-picker-btn" title="Previous Picker" aria-label="Go to previous picker">&#8592;</button>
                            <select id="picker-dropdown" class="picker-dropdown">
                                <option value="Stephen">Stephen</option>
                                <option value="Sean">Sean</option>
                                <option value="Dylan">Dylan</option>
                                <option value="Jason">Jason</option>
                                <option value="Daniel">Daniel</option>
                            </select>
                            <button class="picker-nav-btn" id="next-picker-btn" title="Next Picker" aria-label="Go to next picker">&#8594;</button>
                        </div>
                    </div>
                </div>

                <!-- Game Filters -->
                <div class="game-filters">
                    <button class="filter-btn active" data-filter="all">All Games</button>
                    <button class="filter-btn" data-filter="upcoming">Upcoming</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                </div>

                <!-- Actions -->
                <div class="picks-actions">
                    <button class="btn btn-secondary" id="clear-picks-btn">Clear My Picks</button>
                    <div class="dropdown" id="quick-picks-dropdown">
                        <button class="btn btn-primary dropdown-toggle" id="quick-picks-btn">
                            Quick Picks <span class="dropdown-arrow">▼</span>
                        </button>
                        <div class="dropdown-menu" id="quick-picks-menu">
                            <button class="dropdown-item" id="randomize-picks-btn">Randomize</button>
                            <button class="dropdown-item" id="pick-favorites-btn">Pick All Favorites</button>
                            <button class="dropdown-item" id="pick-underdogs-btn">Pick All Underdogs</button>
                        </div>
                    </div>
                </div>

                <!-- Games List -->
                <div class="games-list" id="games-list">
                    <!-- Games will be injected here -->
                </div>

                <!-- Share Button -->
                <div class="share-picks-container">
                    <button class="btn btn-primary" id="copy-picks-btn">Share Picks</button>
                </div>

                <!-- Admin: Refresh Spreads (Stephen only) -->
                <div class="admin-actions admin-only hidden">
                    <button class="btn btn-secondary btn-small" id="refresh-spreads-btn">
                        Refresh Spreads from API
                    </button>
                </div>

                <!-- Scoring Summary -->
                <div class="scoring-summary collapsible-section" id="scoring-summary" data-section="scoring">
                    <div class="collapsible-header" onclick="toggleSection('scoring')">
                        <h3 class="section-header-title"><span id="scoring-week-num">--</span></h3>
                        <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                    </div>
                    <div class="collapsible-content">
                        <div class="scoring-table-container">
                            <table class="scoring-table" id="scoring-table">
                                <!-- Scoring will be injected here -->
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- vs Market Section -->
            <section id="vs-market-section" class="vs-market-section hidden">
                <!-- Content will be rendered by JavaScript -->
            </section>

        </main>

        <footer>
            <p>Data pulled from <a href="https://docs.google.com/spreadsheets/d/1JuftzmWWIlquN1oKrFqPNaGjMu9ysdnCHqCDj9lYzfE" target="_blank" rel="noopener">published Google Sheet</a></p>
        </footer>
    </div>

    <!-- Onboarding Overlay (first visit only) -->
    <div class="onboarding-overlay" id="onboarding-overlay">
        <div class="onboarding-modal">
            <div class="onboarding-header">
                <h2>Welcome to NFL Picks Dashboard</h2>
                <p>Track and compare NFL picks across the season</p>
            </div>
            <div class="onboarding-steps">
                <div class="onboarding-step">
                    <div class="step-icon">1</div>
                    <div class="step-content">
                        <h3>Make Your Picks</h3>
                        <p>Select a week and picker, then click team buttons to make your picks. Choose both <strong>Line Picks</strong> (against the spread) and <strong>Straight Up</strong> (winner) picks.</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">2</div>
                    <div class="step-content">
                        <h3>Blazin' 5</h3>
                        <p>Mark your 5 most confident picks each week using the star button. These are tracked separately for bragging rights!</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">3</div>
                    <div class="step-content">
                        <h3>View the Tabs</h3>
                        <p>Switch tabs to see leaderboards for <strong>Blazin' 5</strong>, <strong>Line Picks</strong>, and <strong>Straight Up</strong> categories with charts and insights.</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">4</div>
                    <div class="step-content">
                        <h3>Keyboard Shortcuts</h3>
                        <p>Use arrow keys to navigate games, number keys (1-4) to make picks quickly. Press <strong>?</strong> to see all shortcuts.</p>
                    </div>
                </div>
            </div>
            <div class="onboarding-footer">
                <button class="btn btn-primary" id="onboarding-close-btn">Get Started</button>
                <label class="onboarding-checkbox">
                    <input type="checkbox" id="onboarding-dont-show" checked>
                    <span>Don't show this again</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirm-modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modal-title">Confirm Action</h3>
            <p class="modal-message" id="modal-message">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="modal-cancel-btn">Cancel</button>
                <button class="btn btn-danger" id="modal-confirm-btn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="back-to-top" title="Back to top" aria-label="Scroll back to top">&#8593;</button>

    <script src="parser.js"></script>
    <script src="charts.js"></script>
    <script src="historical-data.js"></script>
    <script src="app.js"></script>
</body>
</html>
