<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Picks Dashboard - 2025 Season</title>
    <link rel="icon" type="image/svg+xml" href="https://static.www.nfl.com/image/upload/v1554321393/league/nvfr7ogywskqrfaiu38m.svg">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- Pull to Refresh Indicator (mobile only) -->
    <div class="pull-to-refresh" id="pull-to-refresh">
        <div class="pull-to-refresh-content">
            <div class="pull-to-refresh-icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
                </svg>
            </div>
            <span class="pull-to-refresh-text">Pull to refresh</span>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <a href="/" title="Home"><img src="https://static.www.nfl.com/image/upload/v1554321393/league/nvfr7ogywskqrfaiu38m.svg" alt="NFL Logo" class="nfl-logo"></a>
                <div class="header-text">
                    <h1>NFL Picks Dashboard</h1>
                    <p class="subtitle">2025 Regular Season Tracker</p>
                </div>
                <button class="dark-mode-toggle" id="dark-mode-toggle" title="Toggle dark mode" aria-label="Toggle dark mode">
                    <span class="icon-sun" aria-hidden="true">&#9728;</span>
                    <span class="icon-moon" aria-hidden="true">&#9790;</span>
                </button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main id="dashboard" class="dashboard">
            <!-- Category Tabs -->
            <section class="category-tabs">
                <button class="tab tab-picks active" data-category="make-picks">Make Picks</button>
                <button class="tab" data-category="blazin">Blazin' 5</button>
                <button class="tab" data-category="line">Line Picks</button>
                <button class="tab" data-category="winner">Straight Up</button>
            </section>

            <!-- Loading State -->
            <section class="loading-state" id="loading-state">
                <div class="loading-spinner"></div>
                <p>Loading picks data...</p>
            </section>

            <!-- Error State -->
            <section class="error-state hidden" id="error-state">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h3>Failed to Load Data</h3>
                <p id="error-message">Unable to connect to the data source. Please check your internet connection.</p>
                <button class="btn btn-primary" id="retry-btn">Try Again</button>
            </section>

            <!-- Leaderboard -->
            <section class="leaderboard hidden" id="leaderboard">
                <!-- Cards will be injected here -->
            </section>

            <!-- Charts Section -->
            <section class="charts-grid hidden collapsible-section" data-section="charts">
                <div class="collapsible-header" onclick="toggleSection('charts')">
                    <h3 class="section-header-title">Charts</h3>
                    <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="charts-grid-content">
                        <div class="chart-container">
                            <h3>Weekly Performance Trend</h3>
                            <canvas id="trend-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h3>Favorites vs Underdogs</h3>
                            <canvas id="standings-chart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Insights Section -->
            <section class="insights-section hidden collapsible-section" data-section="insights">
                <div class="collapsible-header" onclick="toggleSection('insights')">
                    <h3 class="section-header-title">Group Insights</h3>
                    <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="insights-grid" id="insights-grid">
                        <!-- Consensus callout -->
                        <div class="insight-card consensus" id="consensus-card">
                            <!-- Injected by JS -->
                        </div>
                        <!-- Lone Wolf leaderboard -->
                        <div class="insight-card lone-wolf" id="lone-wolf-card">
                            <!-- Injected by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Team Pick Frequency Section (Blazin' 5 only) -->
            <section class="team-frequency-section hidden collapsible-section" data-section="team-frequency">
                <div class="collapsible-header" onclick="toggleSection('team-frequency')">
                    <h3 class="section-header-title">Team Pick Frequency</h3>
                    <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                </div>
                <div class="collapsible-content">
                    <p class="section-subtitle">Top 5 teams picked with win percentage</p>
                    <div class="team-frequency-grid" id="team-frequency-grid">
                        <!-- Team frequency cards will be injected here -->
                    </div>
                </div>
            </section>

            <!-- Group Overall Stats Section -->
            <section class="group-stats-section hidden collapsible-section" data-section="group-stats">
                <div class="collapsible-header" onclick="toggleSection('group-stats')">
                    <h3 class="section-header-title">Group Performance</h3>
                    <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="group-stats-grid" id="group-stats-grid">
                        <!-- Group stats cards will be injected here -->
                    </div>
                </div>
            </section>

            <!-- Streaks Section -->
            <section class="streaks-section hidden collapsible-section" data-section="streaks">
                <div class="collapsible-header" onclick="toggleSection('streaks')">
                    <h3 class="section-header-title">Recent Performance</h3>
                    <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                </div>
                <div class="collapsible-content">
                    <div class="streaks-grid" id="streaks-grid">
                        <!-- Streak cards will be injected here -->
                    </div>
                </div>
            </section>

            <!-- Make Picks Section -->
            <section id="make-picks-section" class="make-picks-section">
                <div class="picks-header">
                    <h2>Week <span id="picks-week-num">--</span> Picks</h2>
                </div>

                <!-- Week and Picker Selection -->
                <div class="selection-row">
                    <div class="week-selector">
                        <label for="week-dropdown">Select Week:</label>
                        <div class="week-nav-row">
                            <button class="week-nav-btn" id="prev-week-btn" title="Previous Week" aria-label="Go to previous week">&#8592;</button>
                            <select id="week-dropdown" class="week-dropdown">
                                <!-- Week options will be injected here -->
                            </select>
                            <button class="week-nav-btn" id="next-week-btn" title="Next Week" aria-label="Go to next week">&#8594;</button>
                        </div>
                        <span id="week-loading" class="week-loading hidden">Loading...</span>
                    </div>

                    <div class="picker-selector">
                        <label for="picker-dropdown">Picks for:</label>
                        <select id="picker-dropdown" class="picker-dropdown">
                            <option value="Stephen">Stephen</option>
                            <option value="Sean">Sean</option>
                            <option value="Dylan">Dylan</option>
                            <option value="Jason">Jason</option>
                            <option value="Daniel">Daniel</option>
                        </select>
                    </div>
                </div>

                <!-- Game Filters -->
                <div class="game-filters">
                    <button class="filter-btn active" data-filter="all">All Games</button>
                    <button class="filter-btn" data-filter="upcoming">Upcoming</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                </div>

                <!-- Actions -->
                <div class="picks-actions">
                    <button class="btn btn-secondary" id="clear-picks-btn">Clear My Picks</button>
                    <div class="dropdown" id="quick-picks-dropdown">
                        <button class="btn btn-primary dropdown-toggle" id="quick-picks-btn">
                            Quick Picks <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div class="dropdown-menu" id="quick-picks-menu">
                            <button class="dropdown-item" id="randomize-picks-btn">Randomize</button>
                            <button class="dropdown-item" id="pick-favorites-btn">Pick All Favorites</button>
                            <button class="dropdown-item" id="pick-underdogs-btn">Pick All Underdogs</button>
                        </div>
                    </div>
                </div>

                <!-- Games List -->
                <div class="games-list" id="games-list">
                    <!-- Games will be injected here -->
                </div>

                <!-- Share Button -->
                <div class="share-picks-container">
                    <button class="btn btn-primary" id="copy-picks-btn">Share Picks</button>
                </div>

                <!-- Scoring Summary -->
                <div class="scoring-summary collapsible-section" id="scoring-summary" data-section="scoring">
                    <div class="collapsible-header" onclick="toggleSection('scoring')">
                        <h3 class="section-header-title">Week <span id="scoring-week-num">--</span> Scoring Summary</h3>
                        <span class="collapse-toggle"><span class="collapse-toggle-icon">&minus;</span></span>
                    </div>
                    <div class="collapsible-content">
                        <div class="scoring-table-container">
                            <table class="scoring-table" id="scoring-table">
                                <!-- Scoring will be injected here -->
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Data pulled from <a href="https://docs.google.com/spreadsheets/d/1JuftzmWWIlquN1oKrFqPNaGjMu9ysdnCHqCDj9lYzfE" target="_blank" rel="noopener">published Google Sheet</a></p>
        </footer>
    </div>

    <!-- Sticky Pick Progress Bar -->
    <div class="picks-status-bar hidden" id="picks-status-bar">
        <div class="pick-progress">
            <div class="progress-text">
                <span id="picks-made">0</span>/<span id="picks-total">0</span> picks made
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
        <button class="picks-status-close" id="picks-status-close" title="Dismiss" aria-label="Dismiss progress bar">&times;</button>
    </div>

    <!-- Onboarding Overlay (first visit only) -->
    <div class="onboarding-overlay" id="onboarding-overlay">
        <div class="onboarding-modal">
            <div class="onboarding-header">
                <h2>Welcome to NFL Picks Dashboard</h2>
                <p>Track and compare NFL picks across the season</p>
            </div>
            <div class="onboarding-steps">
                <div class="onboarding-step">
                    <div class="step-icon">üèà</div>
                    <div class="step-content">
                        <h3>Make Your Picks</h3>
                        <p>Select a week and picker, then click team buttons to make your picks. Choose both <strong>Line Picks</strong> (against the spread) and <strong>Straight Up</strong> (winner) picks.</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">‚≠ê</div>
                    <div class="step-content">
                        <h3>Blazin' 5</h3>
                        <p>Mark your 5 most confident picks each week using the star button. These are tracked separately for bragging rights!</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">üìä</div>
                    <div class="step-content">
                        <h3>View the Tabs</h3>
                        <p>Switch tabs to see leaderboards for <strong>Blazin' 5</strong>, <strong>Line Picks</strong>, and <strong>Straight Up</strong> categories with charts and insights.</p>
                    </div>
                </div>
                <div class="onboarding-step">
                    <div class="step-icon">‚å®Ô∏è</div>
                    <div class="step-content">
                        <h3>Keyboard Shortcuts</h3>
                        <p>Use arrow keys to navigate games, number keys (1-4) to make picks quickly. Press <strong>?</strong> to see all shortcuts.</p>
                    </div>
                </div>
            </div>
            <div class="onboarding-footer">
                <button class="btn btn-primary" id="onboarding-close-btn">Get Started</button>
                <label class="onboarding-checkbox">
                    <input type="checkbox" id="onboarding-dont-show" checked>
                    <span>Don't show this again</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirm-modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modal-title">Confirm Action</h3>
            <p class="modal-message" id="modal-message">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="modal-cancel-btn">Cancel</button>
                <button class="btn btn-danger" id="modal-confirm-btn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Keyboard Shortcuts Toggle -->
    <button class="keyboard-toggle-btn hidden" id="keyboard-toggle-btn" title="Keyboard Shortcuts" aria-label="Show keyboard shortcuts">?</button>

    <!-- Keyboard Shortcuts Legend -->
    <div class="keyboard-legend" id="keyboard-legend">
        <div class="keyboard-legend-header">
            <span class="keyboard-legend-title">Keyboard Shortcuts</span>
            <button class="keyboard-legend-close" id="keyboard-legend-close" aria-label="Close keyboard shortcuts">&times;</button>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">‚Üë‚Üì</span>
            <span class="keyboard-desc">Navigate between games</span>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">1</span>
            <span class="keyboard-desc">Select away team (line)</span>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">2</span>
            <span class="keyboard-desc">Select home team (line)</span>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">3</span>
            <span class="keyboard-desc">Select away team (winner)</span>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">4</span>
            <span class="keyboard-desc">Select home team (winner)</span>
        </div>
        <div class="keyboard-shortcut">
            <span class="keyboard-key">‚Üê‚Üí</span>
            <span class="keyboard-desc">Previous/Next week</span>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="back-to-top" title="Back to top" aria-label="Scroll back to top">&#8593;</button>

    <script src="parser.js"></script>
    <script src="charts.js"></script>
    <script src="historical-data.js"></script>
    <script src="app.js"></script>
</body>
</html>
